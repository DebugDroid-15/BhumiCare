<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart BhumiCare â€” Smart Agronomist</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- Highcharts for modern gauges -->
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/solid-gauge.js"></script>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "YOUR_FIREBASE_API_KEY",
    authDomain: "YOUR_FIREBASE_PROJECT.firebaseapp.com",
    databaseURL: "https://bhumicare-b6713-default-rtdb.firebaseio.com",
    projectId: "YOUR_FIREBASE_PROJECT",
    storageBucket: "YOUR_FIREBASE_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
</script>

<style>
body { margin:0; font-family:'Poppins',sans-serif; background:#f0f4f8; color:#1b5e20; }
header { text-align:center; padding:16px 0; background:#2e7d32; color:white; font-size:24px; font-weight:700; box-shadow:0 2px 6px rgba(0,0,0,0.15);}
.controls { text-align:center; margin:12px 0;}
select { padding:8px 12px; font-size:14px; border-radius:8px; border:1px solid #2e7d32; width:90%; max-width:300px; }
.gauges { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; padding:16px;}
.gauge-card { background:#fff; border-radius:12px; padding:12px; box-shadow:0 4px 14px rgba(0,0,0,0.12); text-align:center; position:relative;}
.gauge-card h3 { margin:6px 0; font-size:16px; color:#2e7d32;}
.suggestions { max-width:1200px; margin:0 auto; padding:16px; background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
.map-container { margin:20px auto; max-width:1200px; height:60vh; border-radius:12px; overflow:hidden; }
@media(max-width:640px){ .gauges { grid-template-columns:repeat(auto-fit,minmax(150px,1fr)); } }
</style>
</head>
<body>

<header>ðŸŒ± Smart BhumiCare â€” Smart Agronomist</header>

<div class="controls">
  <label for="cropSelect">Select Crop: </label>
  <select id="cropSelect"></select>
</div>

<div class="gauges">
  <div class="gauge-card"><h3>Soil Moisture (%)</h3><div id="soilMoistureGauge"></div></div>
  <div class="gauge-card"><h3>Temperature (Â°C)</h3><div id="temperatureGauge"></div></div>
  <div class="gauge-card"><h3>Humidity (%)</h3><div id="humidityGauge"></div></div>
  <div class="gauge-card"><h3>EC (dS/m)</h3><div id="ecGauge"></div></div>
  <div class="gauge-card"><h3>pH Level</h3><div id="phGauge"></div></div>
  <div class="gauge-card"><h3>Fertility Index</h3><div id="fertilityGauge"></div></div>
  <div class="gauge-card"><h3>N (ppm)</h3><div id="nGauge"></div></div>
  <div class="gauge-card"><h3>P (ppm)</h3><div id="pGauge"></div></div>
  <div class="gauge-card"><h3>K (ppm)</h3><div id="kGauge"></div></div>
  <div class="gauge-card"><h3>TDS (ppm)</h3><div id="tdsGauge"></div></div>
  <div class="gauge-card"><h3>Salinity Index</h3><div id="salinityGauge"></div></div>
  <div class="gauge-card"><h3>Moisture Stress</h3><div id="moistureStressGauge"></div></div>
  <div class="gauge-card"><h3>Temperature Stress</h3><div id="tempStressGauge"></div></div>
  <div class="gauge-card"><h3>Soil Organic Proxy (%)</h3><div id="soilOrganicGauge"></div></div>
  <div class="gauge-card"><h3>DHT Temp (Â°C)</h3><div id="dhtTempGauge"></div></div>
  <div class="gauge-card"><h3>DHT Humidity (%)</h3><div id="dhtHumidityGauge"></div></div>
  <div class="gauge-card"><h3>MQ2 Gas (ppm)</h3><div id="mq2Gauge"></div></div>
  <div class="gauge-card"><h3>LDR Light (lux)</h3><div id="ldrGauge"></div></div>
</div>

<div class="suggestions" id="suggestionsBox">
  <h3>Crop Recommendations</h3>
  <ul id="suggestionList"></ul>
</div>

<div class="map-container">
  <iframe id="fieldMap" loading="lazy" allowfullscreen 
    src="https://www.google.com/maps?q=20.5937,78.9629&z=10&output=embed" 
    title="Field Location" width="100%" height="100%"></iframe>
</div>

<script type="module">
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

const db = getDatabase();

// ================= Gauge Helper =================
const createGauge=(id,title,min,max,unit)=>{
  return Highcharts.chart(id,{
    chart: { type: 'solidgauge', height: '200px' },
    title: null,
    pane: { center: ['50%', '50%'], size: '100%', startAngle: -90, endAngle: 90,
      background: { backgroundColor:'#EEE', innerRadius:'60%', outerRadius:'100%', shape:'arc' } },
    tooltip: { enabled:false },
    yAxis: { min:min, max:max, stops:[[0,'#d32f2f'],[0.5,'#fbc02d'],[1,'#4caf50']],
      lineWidth:0, tickPositions:[] },
    plotOptions: { solidgauge: { dataLabels: { y:0, borderWidth:0, useHTML:true, format:'<div style="text-align:center"><span style="font-size:18px">{y} '+unit+'</span></div>' } } },
    series: [{ name:title, data:[0] }]
  });
};

// ================= Initialize All Gauges =================
const gauges = {
  soilMoisture:createGauge('soilMoistureGauge','Soil Moisture',0,100,'%'),
  temperature:createGauge('temperatureGauge','Temperature',0,50,'Â°C'),
  humidity:createGauge('humidityGauge','Humidity',0,100,'%'),
  ec:createGauge('ecGauge','EC',0,5,'dS/m'),
  ph:createGauge('phGauge','pH',0,14,''),
  fertility:createGauge('fertilityGauge','Fertility Index',0,100,''),
  N:createGauge('nGauge','N',0,200,'ppm'),
  P:createGauge('pGauge','P',0,100,'ppm'),
  K=createGauge('kGauge','K',0,100,'ppm'),
  TDS=createGauge('tdsGauge','TDS',0,1000,'ppm'),
  salinity:createGauge('salinityGauge','Salinity',0,100,''),
  moistureStress:createGauge('moistureStressGauge','Moisture Stress',0,100,''),
  tempStress:createGauge('tempStressGauge','Temp Stress',0,100,''),
  soilOrganic:createGauge('soilOrganicGauge','Soil Organic Proxy',0,10,'%'),
  dhtTemp:createGauge('dhtTempGauge','DHT Temp',0,50,'Â°C'),
  dhtHumidity:createGauge('dhtHumidityGauge','DHT Humidity',0,100,'%'),
  mq2:createGauge('mq2Gauge','MQ2 Gas',0,500,'ppm'),
  ldr:createGauge('ldrGauge','LDR Light',0,1000,'lux')
};

// ================= Crop Suggestions =================
const cropSuggestions = {
  { name: 'Rice', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Check for pests regularly'] },
    { name: 'Wheat', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7.5', 'Irrigate if soil moisture <30%', 'Ensure crop rotation'] },
    { name: 'Maize', suggestions: ['Maintain soil moisture 65-75%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <40%', 'Check for pest infestations'] },
    { name: 'Barley', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <25%', 'Ensure proper drainage'] },
    { name: 'Sorghum', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pest infestations'] },
    { name: 'Pearl Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <20%', 'Ensure proper drainage'] },
    { name: 'Finger Millet', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pest infestations'] },
    { name: 'Pulses', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <20%', 'Ensure proper drainage'] },
    { name: 'Groundnut', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pest infestations'] },
    { name: 'Soybean', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Ensure proper drainage'] },
    { name: 'Cotton', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pest infestations'] },
    { name: 'Sugarcane', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Ensure proper drainage'] },
    { name: 'Tobacco', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pest infestations'] },
    { name: 'Oilseeds', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <25%', 'Ensure proper drainage'] },
    { name: 'Tea', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Check for pests regularly'] },
    { name: 'Coffee', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Ensure proper drainage'] },
    { name: 'Coconut', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Check for pests regularly'] },
    { name: 'Areca Nut', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Check for pests regularly'] },
    { name: 'Banana', suggestions: ['Maintain soil moisture 75-85%', 'Apply NPK fertilizer as per growth stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <40%', 'Ensure proper drainage'] },
    { name: 'Papaya', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Protect from strong winds'] },
    { name: 'Mango', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate during dry spells', 'Check for mango hoppers and pests'] },
    { name: 'Guava', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Prune regularly'] },
    { name: 'Pomegranate', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <25%', 'Ensure proper drainage'] },
    { name: 'Litchi', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate during dry spells', 'Protect young plants from frost'] },
    { name: 'Sapota', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Mulch around roots to retain moisture'] },
    { name: 'Jackfruit', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Check for fruit borer'] },
    { name: 'Cashew', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate during dry spells', 'Protect from anthracnose disease'] },
    { name: 'Chikoo (Sapodilla)', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Prune to maintain canopy'] },
    { name: 'Strawberry', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 5.5-6.5', 'Irrigate during dry spells', 'Ensure proper drainage'] },
    { name: 'Tomato', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for leaf curl virus'] },
    { name: 'Brinjal (Eggplant)', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for shoot and fruit borer'] },
    { name: 'Chili', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pests regularly'] },
    { name: 'Capsicum', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure proper sunlight'] },
    { name: 'Cucumber', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate during dry spells', 'Provide trellis support'] },
    { name: 'Bottle Gourd', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Train vines properly'] },
    { name: 'Pumpkin', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Control powdery mildew'] },
    { name: 'Bitter Gourd', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Support climbing'] },
    { name: 'Snake Gourd', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Provide trellis support'] },
    { name: 'Okra (Lady Finger)', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for pests and blight'] },
    { name: 'Cabbage', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from whiteflies and pests'] },
    { name: 'Cauliflower', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for aphids'] },
    { name: 'Carrot', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure loose soil for root growth'] },
    { name: 'Radish', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for pests'] },
    { name: 'Beetroot', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure loose soil for roots'] },
    { name: 'Spinach', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Harvest leaves periodically'] },
    { name: 'Fenugreek', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pests'] },
    { name: 'Coriander', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Harvest leaves periodically'] },
    { name: 'Mint', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Harvest leaves as needed'] },
    { name: 'Basil', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Harvest leaves as needed'] },
    { name: 'Lettuce', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from pests'] },
    { name: 'Kale', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for aphids'] },
    { name: 'Mustard', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for pests and disease'] },
    { name: 'Sunflower', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <40%', 'Support stems if needed'] },
    { name: 'Groundnut', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure proper drainage'] },
    { name: 'Soybean', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Monitor for pests'] },
    { name: 'Green Gram', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Harvest at maturity'] },
    { name: 'Black Gram', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pests'] },
    { name: 'Red Gram', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Protect from pod borers'] },
    { name: 'Chickpea', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <35%', 'Ensure good soil drainage'] },
    { name: 'Pigeon Pea', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Check for pests'] },
    { name: 'Cowpea', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Harvest pods timely'] },
    { name: 'Sesame', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if dry', 'Protect from pests'] },
    { name: 'Sunflower', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Ensure proper sunlight'] },
    { name: 'Cotton', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate during dry spells', 'Check for bollworm and pests'] },
    { name: 'Sugarcane', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure proper drainage'] },
    { name: 'Tobacco', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from leaf diseases'] },
    { name: 'Tea', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 5-6', 'Irrigate as needed', 'Pluck leaves carefully'] },
    { name: 'Coffee', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 5-6', 'Irrigate regularly', 'Protect from pests'] },
    { name: 'Rubber', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 5-6', 'Irrigate as needed', 'Check for fungal infections'] },
    { name: 'Coconut', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from pests and wind'] },
    { name: 'Maize', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for stem borer'] },
    { name: 'Rice', suggestions: ['Maintain soil moisture 70-80%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Ensure water management'] },
    { name: 'Wheat', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if dry', 'Check for rust and pests'] },
    { name: 'Barley', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Protect from fungal infections'] },
    { name: 'Oats', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Check for aphids'] },
    { name: 'Sorghum', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Check for stem borer'] },
    { name: 'Pearl Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate if soil moisture <30%', 'Check for pests'] },
    { name: 'Foxtail Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Harvest timely'] },
    { name: 'Little Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Check for pests'] },
    { name: 'Kodo Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if dry', 'Harvest at maturity'] },
    { name: 'Barnyard Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Check for pests'] },
    { name: 'Finger Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Ensure good soil aeration'] },
    { name: 'Proso Millet', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Harvest timely'] },
    { name: 'Buckwheat', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Protect from pests'] },
    { name: 'Quinoa', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Ensure good sunlight'] },
    { name: 'Amaranth', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Harvest leaves periodically'] },
    { name: 'Chia', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Protect from pests'] },
    { name: 'Flax', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate as needed', 'Harvest at seed maturity'] },
    { name: 'Sunflower', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Support tall stems'] },
    { name: 'Sesbania', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Use as green manure'] },
    { name: 'Vigna', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Harvest pods timely'] },
    { name: 'Arhar (Tur)', suggestions: ['Maintain soil moisture 40-50%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate if dry', 'Check for pests'] },
    { name: 'Peas', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Support climbing'] },
    { name: 'Sweet Potato', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure loose soil for roots'] },
    { name: 'Yam', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for pests'] },
    { name: 'Taro', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from fungal diseases'] },
    { name: 'Arrowroot', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Ensure proper drainage'] },
    { name: 'Ginger', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Mulch around roots'] },
    { name: 'Turmeric', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Mulch and protect rhizomes'] },
    { name: 'Garlic', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from pests'] },
    { name: 'Onion', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Ensure good sunlight'] },
    { name: 'Shallots', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Check for pests'] },
    { name: 'Leek', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Protect from diseases'] },
    { name: 'Celery', suggestions: ['Maintain soil moisture 60-70%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Ensure proper spacing'] },
    { name: 'Asparagus', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer appropriately', 'Monitor pH 6-7', 'Irrigate as needed', 'Support shoots if needed'] },
    { name: 'Artichoke', suggestions: ['Maintain soil moisture 50-60%', 'Apply NPK fertilizer as per stage', 'Monitor pH 6-7', 'Irrigate regularly', 'Protect from pests'] }
};

// ================= Populate Crop Dropdown =================
const cropSelect = document.getElementById('cropSelect');
Object.keys(cropSuggestions).forEach(crop=>{
  const opt = document.createElement('option'); opt.value=crop; opt.textContent=crop; cropSelect.appendChild(opt);
});

// ================= Update Suggestions =================
const suggestionList = document.getElementById('suggestionList');
function updateSuggestions(){
  const crop = cropSelect.value;
  suggestionList.innerHTML = '';
  if(cropSuggestions[crop]){
    cropSuggestions[crop].forEach(s => {
      const li = document.createElement('li'); li.textContent = s; suggestionList.appendChild(li);
    });
  }
}
cropSelect.addEventListener('change',updateSuggestions);
window.onload=updateSuggestions;

// ================= Firebase Live Updates =================
const sensorsRef = ref(db,'/SensorData');
onValue(sensorsRef,snapshot=>{
  const data = snapshot.val();
  if(!data) return;
  const keys = Object.keys(data);
  const latest = data[keys[keys.length-1]];

  if(latest){
    gauges.soilMoisture.series[0].setData([latest.moistureNPK||0]);
    gauges.temperature.series[0].setData([latest.tempNPK||0]);
    gauges.humidity.series[0].setData([latest.humidityDHT||0]);
    gauges.ec.series[0].setData([latest.ec||0]);
    gauges.ph.series[0].setData([latest.pH||0]);
    gauges.fertility.series[0].setData([latest.fertilityIndex||0]);
    gauges.N.series[0].setData([latest.N||0]);
    gauges.P.series[0].setData([latest.P||0]);
    gauges.K.series[0].setData([latest.K||0]);
    gauges.TDS.series[0].setData([latest.TDS||0]);
    gauges.salinity.series[0].setData([latest.salinityIndex||0]);
    gauges.moistureStress.series[0].setData([latest.moistureStress||0]);
    gauges.tempStress.series[0].setData([latest.tempStress||0]);
    gauges.soilOrganic.series[0].setData([latest.soilOrganicProxy||0]);
    gauges.dhtTemp.series[0].setData([latest.temperatureDHT||0]);
    gauges.dhtHumidity.series[0].setData([latest.humidityDHT||0]);
    gauges.mq2.series[0].setData([latest.mq2Raw||0]);
    gauges.ldr.series[0].setData([latest.ldrRaw||0]);

    // Update map location
    if(latest.gpsLat && latest.gpsLng){
      document.getElementById('fieldMap').src = `https://www.google.com/maps?q=${latest.gpsLat},${latest.gpsLng}&z=15&output=embed`;
    }
  }
});
</script>

</body>
</html>
